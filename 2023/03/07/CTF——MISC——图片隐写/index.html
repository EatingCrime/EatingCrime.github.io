<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="MISC—图片隐写, OrigiN">
    <meta name="description" content="CTF——MISC——图片隐写常规思路图片名及图片内容除了题目描述和给的提示外，注意图片名和图片里的内容，很有可能是接下来要用到的隐写工具或者加密方法的提示。
例如第四届蓝帽杯决赛的一道misc：MISC隐写 给了一张图片，里面是一条蛇，这">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>MISC—图片隐写 | OrigiN</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">OrigiN</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">OrigiN</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/10.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">MISC—图片隐写</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CTF/" class="post-category">
                                CTF
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-03-07
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="CTF——MISC——图片隐写"><a href="#CTF——MISC——图片隐写" class="headerlink" title="CTF——MISC——图片隐写"></a>CTF——MISC——图片隐写</h1><h1 id="常规思路"><a href="#常规思路" class="headerlink" title="常规思路"></a>常规思路</h1><h2 id="图片名及图片内容"><a href="#图片名及图片内容" class="headerlink" title="图片名及图片内容"></a>图片名及图片内容</h2><p>除了题目描述和给的提示外，注意<code>图片名</code>和<code>图片里的内容</code>，很有可能是接下来要用到的<code>隐写工具或者加密方法的提示</code>。</p>
<p>例如<code>第四届蓝帽杯决赛</code>的一道misc：<code>MISC隐写</code> 给了一张图片，里面是一条蛇，这个提示的是后面会用到的一种解密方法；然后从图片中提取出一个pdf文件，文件名是<code>no password.pdf</code>，也提示了需要用到工具，不需要输入密码。</p>
<h3 id="bpg图片"><a href="#bpg图片" class="headerlink" title="bpg图片"></a>bpg图片</h3><p>bpg格式的图片在windows系统下是不能直接查看的，需要<a target="_blank" rel="noopener" href="https://bellard.org/bpg/">下载工具</a><br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70.png" alt="在这里插入图片描述"><br>输入命令查看图片<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513421.png" alt="在这里插入图片描述"></p>
<h3 id="exif信息"><a href="#exif信息" class="headerlink" title="exif信息"></a>exif信息</h3><p>拿到一个图片时，建议查看一下它的exif信息，可能会有意想不到的收获<br>出题人经常在图片的exif信息中藏flag或者提示信息，这里以bugku的misc题目<code>有黑白棋的棋盘</code>为例<img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513442.png" alt="在这里插入图片描述"><br>这里是直接右键查看属性，不过这样能获取的信息<code>十分有限</code>；<br>ctfshow中八神出的<code>misc入门</code>的<code>misc18-21</code>考察的都是这个知识点，具体可以看我<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45696568/article/details/115261347">另一篇博客</a>。</p>
<p>拿其中的<code>misc20</code>为例，直接右键查看属性，翻看详细信息，得不到任何线索，推荐使用一个<a target="_blank" rel="noopener" href="https://exif.tuchong.com/view/10809574/">在线查看exif信息的网站</a>，这里能得到的结果更详细，也可以使用exiftool<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513443.png" alt="在这里插入图片描述"></p>
<h2 id="修改图片宽高"><a href="#修改图片宽高" class="headerlink" title="修改图片宽高"></a>修改图片宽高</h2><p>很多时候，所给的图片的宽高，甚至crc32校验值都是被修改过的，需要我们去爆破得到正确的值。</p>
<p>这里推荐使用<code>010editor</code>，它的<code>模板功能</code>非常好用，我是010editor+winhex配合使用的。<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513444.png" alt="在这里插入图片描述"></p>
<h3 id="png"><a href="#png" class="headerlink" title="png"></a>png</h3><p>png图片修改宽高还是很容易的，这里是<code>png.bt</code>模板，框中的值分别是<code>宽高</code>和<code>crc值</code>，这里修改之后保存即可<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513445.png" alt="在这里插入图片描述"><br>对于png，一般情况下，是把<code>高度改大</code>，看下面有没有内容<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513456.png" alt="在这里插入图片描述"></p>
<h3 id="jpg"><a href="#jpg" class="headerlink" title="jpg"></a>jpg</h3><p>运用<code>jpg.bt</code>，可以很方便修改jpg的宽高<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513457.png" alt="在这里插入图片描述"><br>对于jpg，一般情况下也是把<code>高度改大</code>，能看到图片下面的内容</p>
<h3 id="gif"><a href="#gif" class="headerlink" title="gif"></a>gif</h3><p>整体和前两种差不多，借助<code>gif.bt</code>，这里比较特殊的是，<code>每一帧都有独立的宽高</code>，因为不知道flag藏在哪一帧，一般<code>建议把所有帧的高度都改大</code>，然后用<code>Stegsolve</code>打开，翻看每一帧图片。</p>
<h3 id="bmp"><a href="#bmp" class="headerlink" title="bmp"></a>bmp</h3><p>借助<code>bmp.bt</code>，整体和前面差不多，当宽度错误时，图片显示很乱<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/20210424113512796.png" alt="在这里插入图片描述"><br>问题就是如何计算正确的宽度和高度，以ctfshow-misc入门的<code>misc24</code>为例，<img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513458.png" alt="在这里插入图片描述"><br>目前是<code>900*150=135000</code>个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%83%8F%E7%B4%A0&spm=1001.2101.3001.7020">像素</a>大小，文件头占了53个字节，文件尾的位置在675053字节处(后面两个字节是windows的”补0”)，又因为每个像素点由3个字节（十六进制码6位）表示，每个字节负责控制一种颜色，分别为蓝（Blue）、绿（Green）、红（Red），所以文件真实的像素大小为：<code>(675053-53)/3=225000</code></p>
<p>这题中给出了正确的宽度900，所以正确的高度就是<code>225000/900=250</code></p>
<h3 id="爆破脚本"><a href="#爆破脚本" class="headerlink" title="爆破脚本"></a>爆破脚本</h3><p>png图片，<code>已知正确的IHDR块的CRC值</code>时，爆破宽度和高度</p>
<pre><code class="python">import zlib
import struct

# 同时爆破宽度和高度
filename = &quot;misc32.png&quot;
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    data = bytearray(all_b[12:29])
    n = 4095
    for w in range(n):
        width = bytearray(struct.pack(&#39;&gt;i&#39;, w))
        for h in range(n):
            height = bytearray(struct.pack(&#39;&gt;i&#39;, h))
            for x in range(4):
                data[x+4] = width[x]
                data[x+8] = height[x]
            crc32result = zlib.crc32(data)
            #替换成图片的crc
            if crc32result == 0xE14A4C0B:
                print(&quot;宽为：&quot;, end = &#39;&#39;)
                print(width, end = &#39; &#39;)
                print(int.from_bytes(width, byteorder=&#39;big&#39;))
                print(&quot;高为：&quot;, end = &#39;&#39;)
                print(height, end = &#39; &#39;)
                print(int.from_bytes(height, byteorder=&#39;big&#39;))
12345678910111213141516171819202122232425
</code></pre>
<p>png图片，如果<code>IHDR块的CRC的值被修改过</code>，那就直接爆破，运行后会生成很多个图片，看一下哪个是正常的就行<br>这里是<code>已知高度的情况下爆破宽度</code>，根据自己需要修改脚本</p>
<pre><code class="python">import zlib
import struct
filename = &quot;misc34.png&quot;
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    #w = all_b[16:20]
    #h = all_b[20:24]
    for i in range(901,1200):  #界定宽度的范围
        name = str(i) + &quot;.png&quot;
        f1 = open(name,&quot;wb&quot;)
        im = all_b[:16]+struct.pack(&#39;&gt;i&#39;,i)+all_b[20:]
        f1.write(im)
        f1.close()
12345678910111213
</code></pre>
<hr>
<p>jpg图片，已知高度，<code>爆破宽度</code><br>如果跑出来的图片看不到想要的东西，可能是狗出题人<code>把原本的高度调小了</code>，可以试一下把高度改大，再跑一遍试试</p>
<pre><code class="python">import zlib
import struct
filename = &quot;misc35.jpg&quot;
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    #w = all_b[159:161]
    #h = all_b[157:159]
    for i in range(901,1200): #界定宽度范围
        name = str(i) + &quot;.jpg&quot;
        f1 = open(name,&quot;wb&quot;)
        im = all_b[:159]+struct.pack(&#39;&gt;h&#39;,i)+all_b[161:]
        f1.write(im)
        f1.close()
12345678910111213
</code></pre>
<hr>
<p>gif图片，已知高度<code>爆破宽度</code><br>如果跑出来没东西，试试把高度改高</p>
<pre><code class="python">import zlib
import struct
filename = &quot;misc36.gif&quot;
with open(filename, &#39;rb&#39;) as f:
    all_b = f.read()
    for i in range(920,951):
        name = str(i) + &quot;.gif&quot;
        f1 = open(name,&quot;wb&quot;)
        im = all_b[:38]+struct.pack(&#39;&gt;h&#39;,i)[::-1]+all_b[40:]
        f1.write(im)
        f1.close()
1234567891011
</code></pre>
<h2 id="查看文件的字节"><a href="#查看文件的字节" class="headerlink" title="查看文件的字节"></a>查看文件的字节</h2><p>使用010editor和winhex对文件进行分析</p>
<h3 id="分析文件头文件尾"><a href="#分析文件头文件尾" class="headerlink" title="分析文件头文件尾"></a>分析文件<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%A4%B4%E6%96%87%E4%BB%B6&spm=1001.2101.3001.7020">头文件</a>尾</h3><p>如果图片打开错误，先看看文件头和文件尾出错没，如果有错误进行修改</p>
<blockquote>
<p>JPEG (jpg)，<br>文件头：FFD8FF　　 文件尾：FF D9　<br>　　　　　　　　　　　　　　<br>PNG (png)， 　　<br>文件头：89504E47　 文件尾：AE 42 60 82<br>GIF (gif)， 　　<br>文件头：47494638　 文件尾：00 3B<br>ZIP Archive (zip)，<br>文件头：504B0304　　 文件尾：50 4B<br>TIFF (tif)， 　<br>文件头：49492A00<br>Windows Bitmap (bmp)， 　<br>文件头：424D<br>　　　　　　<br>CAD (dwg)， 　<br>文件头：41433130　<br>　　　　　　　　　　　　　　　　　　　　　<br>Adobe Photoshop (psd)，<br>文件头：38425053　<br>　　　　　　　　　　　　　　　　　　　　　<br>Rich Text Format (rtf)，<br>文件头：7B5C727466　<br>　　　　　　　　　　　　　　　　　　　<br>XML (xml)，<br>文件头：3C3F786D6C　<br>　　　　　　　　　　　　　　　　　　　<br>HTML (html)，<br>文件头：68746D6C3E<br>Email [thorough only] (eml)，<br>文件头：44656C69766572792D646174653A<br>Outlook Express (dbx)，<br>文件头：CFAD12FEC5FD746F<br>Outlook (pst)，<br>文件头：2142444E<br>MS Word&#x2F;Excel (xls.or.doc)，<br>文件头：D0CF11E0<br>MS Access (mdb)，<br>文件头：5374616E64617264204A<br>WordPerfect (wpd)，<br>文件头：FF575043<br>Adobe Acrobat (pdf)，<br>文件头：255044462D312E<br>Quicken (qdf)，<br>文件头：AC9EBD8F<br>Windows Password (pwl)，<br>文件头：E3828596<br>RAR Archive (rar)，<br>文件头：52617221<br>Wave (wav)， 文件头：57415645<br>AVI (avi)， 文件头：41564920<br>Real Audio (ram)， 文件头：2E7261FD<br>Real Media (rm)， 文件头：2E524D46<br>MPEG (mpg)， 文件头：000001BA<br>MPEG (mpg)， 文件头：000001B3<br>Quicktime (mov)， 文件头：6D6F6F76<br>Windows Media (asf)， 文件头：3026B2758E66CF11<br>MIDI (mid)， 文件头：4D546864</p>
</blockquote>
<h3 id="看看字节流中有没有隐藏信息"><a href="#看看字节流中有没有隐藏信息" class="headerlink" title="看看字节流中有没有隐藏信息"></a>看看<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E8%8A%82%E6%B5%81&spm=1001.2101.3001.7020">字节流</a>中有没有隐藏信息</h3><p>推荐使用<code>winhex</code>或者<code>notepad</code>，打开后直接拉到底部，看有没有什么额外信息<br>然后直接ctrl+f搜索<code>key</code>、<code>flag</code>、<code>password</code>等字样，没准就拿到flag了<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-16683528513459.png" alt="在这里插入图片描述"><br>也有可能不是直接给到的，需要进行进一步的处理<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/20210424115620603.png" alt="在这里插入图片描述"></p>
<p>其实更常见的是，在尾部隐写另一个文件的数据，一般是一个压缩包，可以手动把数据提取出来，或者使用<code>foremost</code>或<code>binwalk</code>提取。</p>
<h2 id="使用stegsolve"><a href="#使用stegsolve" class="headerlink" title="使用stegsolve"></a>使用stegsolve</h2><p>stegsolve是非常常用的工具，功能十分强大</p>
<p>用stegsolve打开图片后，建议<code>先把所有的图层都看一遍</code>，可能会有flag或者提示信息</p>
<p>如果是gif图片，可以使用<code>frame browser</code>查看所有帧<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/20210424120608326.png" alt="在这里插入图片描述"></p>
<p>如果是两张很相似的图片，但是其中一张有很难以辨认的文字痕迹，可以用<code>image combiner</code>功能</p>
<h3 id="lsb隐写"><a href="#lsb隐写" class="headerlink" title="lsb隐写"></a>lsb隐写</h3><p>在翻看图层的时候，可能会发现lsb隐写的痕迹(不太好描述，做习惯了就知道)</p>
<p>使用stegsolve的<code>data extract</code>，选上对应的通道(比较常见的是如下配置)，就可以得到隐藏的信息<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134510.png" alt="在这里插入图片描述"></p>
<h3 id="有密码的lsb隐写"><a href="#有密码的lsb隐写" class="headerlink" title="有密码的lsb隐写"></a>有密码的lsb隐写</h3><p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/cyberinc/cloacked-pixel">https://github.com/cyberinc/cloacked-pixel</a></p>
<p>这个项目是基于<code>python2</code>的，如果环境中同时有Py2和Py3需要注意下</p>
<pre><code class="python">加密
python2 lsb.py hide &lt;img_file&gt; &lt;payload_file&gt; &lt;password&gt;
解密
python2 lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt;
1234
</code></pre>
<h2 id="gif帧数间隔隐写"><a href="#gif帧数间隔隐写" class="headerlink" title="gif帧数间隔隐写"></a>gif帧数间隔隐写</h2><p>使用linux下的工具<code>identify</code></p>
<pre><code class="javascript">安装命令：sudo apt-get install imagemagick
基本的命令格式：
　　identify [options] input-fileidentify:命令名称
　　options:参数
　　input-file:文件名。
提取命令：identify -format &quot;%T &quot; misc39.gif &gt; 1.txt
123456
</code></pre>
<p>提取之后会得到一系列数字，一般是由两种数字重复组成，其中一种转成1，另一种换成0，得到一长串二进制，后面一般是<code>转字符</code>或者<code>转二维码</code></p>
<h2 id="apng帧数间隔隐写"><a href="#apng帧数间隔隐写" class="headerlink" title="apng帧数间隔隐写"></a>apng帧数间隔隐写</h2><p>apng也是和gif一样会动的，使用工具<code>APNG Disassembler</code>提取出每一帧图片，和对应的详细信息，其中就包括<code>间隔时间</code>，注意使用这个工具的时候，提前把图片放在一个文件夹里…</p>
<p>后面步骤同上</p>
<h1 id="工具隐写"><a href="#工具隐写" class="headerlink" title="工具隐写"></a>工具隐写</h1><h2 id="SilentEye"><a href="#SilentEye" class="headerlink" title="SilentEye"></a>SilentEye</h2><p>打开图片后点<strong>decode</strong>进行解密<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134511.png" alt="在这里插入图片描述"><br>可以注意到有bmp和jpg两种，如果有密码，勾选<code>encrypteddata</code>输入密码再解密即可<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134512.png" alt="在这里插入图片描述"></p>
<h2 id="OurSecret"><a href="#OurSecret" class="headerlink" title="OurSecret"></a>OurSecret</h2><p>也是很常用的工具，如果解题需要用到这个工具，出题人一般会给提示，比如<code>我们的秘密是绿色的</code>，其中的<strong>秘密</strong>英文是<strong>Secret</strong>，就是暗示用这个工具。</p>
<p>也是windows下的软件，界面如下<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134613.png" alt="在这里插入图片描述"><br>使用也很简单，在右侧(<strong>UNHIDE</strong>)打开文件，输入密码，再点击UNHIDE就行</p>
<h2 id="S-Tools"><a href="#S-Tools" class="headerlink" title="S-Tools"></a>S-Tools</h2><p><a target="_blank" rel="noopener" href="https://www.cs.vu.nl/~ast/books/mos2/zebras.html">下载地址及详细内容</a></p>
<h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><p>打开之后，把要加密的图片拖进去，然后把要隐写的文件也拖进去，此时会提示让输入密码，设置密码后得到隐写后的文件</p>
<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>打开之后，把要解密的图片拖进去，然后<code>右键→Reveal→输入密码</code><br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134614.png" alt="在这里插入图片描述"><br>就可以得到隐藏的文件了</p>
<h2 id="jpg-1"><a href="#jpg-1" class="headerlink" title="jpg"></a>jpg</h2><h3 id="JAVA盲水印"><a href="#JAVA盲水印" class="headerlink" title="JAVA盲水印"></a>JAVA盲水印</h3><p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/ww23/BlindWaterMark/releases">https://github.com/ww23/BlindWaterMark/releases</a></p>
<p>使用命令：<code>java -jar BlindWatermark.jar decode -c bingbing.jpg decode.jpg</code></p>
<h3 id="stegdetect使用方法"><a href="#stegdetect使用方法" class="headerlink" title="stegdetect使用方法"></a>stegdetect使用方法</h3><h4 id="将测试文件和Stegdetect-exe文件放一起"><a href="#将测试文件和Stegdetect-exe文件放一起" class="headerlink" title="将测试文件和Stegdetect.exe文件放一起"></a>将测试文件和Stegdetect.exe文件放一起</h4><p><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/62e8dc7a72ff4031adb19ae68dfc2424.png" alt="img"></p>
<h4 id="打开命令提示符并进入文件夹里"><a href="#打开命令提示符并进入文件夹里" class="headerlink" title="打开命令提示符并进入文件夹里"></a>打开命令提示符并进入文件夹里</h4><p>win+R</p>
<p>cmd回车</p>
<p>进入到Stegdetect文件夹里面</p>
<p><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/45c1b564fcc64e119666fbe8d173e2b5.png" alt="img"></p>
<h4 id="检测文件"><a href="#检测文件" class="headerlink" title="检测文件"></a>检测文件</h4><p>执行Stegdetect.exe检测</p>
<p>①.\Stegdetect.exe -tjopi -s 10.0 test.jpg</p>
<p>test.jpg : negative（否定）</p>
<p>应该是没找到</p>
<p><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/ec316b9fd6cd479a9ce33796e89a6122.png" alt="img"></p>
<p>②.\Stegdetect.exe -tjopi -s 10.0 1.jpg</p>
<p>Corrupt JPEG data: 2684 extraneous bytes before marker 0xbf<br>1.jpg : error: Unsupported marker type 0xbf</p>
<p>损坏的JPEG数据：2684个小字节在标记之前0xbf之前<br>1.JPG：错误：未支撑的标记类型0xbf</p>
<h4 id="第四步：结果分析"><a href="#第四步：结果分析" class="headerlink" title="第四步：结果分析"></a>第四步：结果分析</h4><p>损坏的第2684个字节的位置，应该被插入了数据</p>
<p>但是未检测出对应的软件</p>
<p>再使用数据编辑工具提取分析出插入的数据</p>
<h4 id="补充：批量操作"><a href="#补充：批量操作" class="headerlink" title="补充：批量操作"></a>补充：批量操作</h4><p>.\stegdetect.exe -tjopi -s10.0 *.jpg</p>
<p><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/b9cca4af2b934265931ab1428d7e195a.png" alt="img"></p>
<p>6.1、模板：<br>stegdetect [ −qnV] [ −s float] [ −d num] [ −t tests] [file …]</p>
<p>6.2、命令：<br>-q：仅显示可能包含隐藏内容的图像</p>
<p>-n：启用检查JPEG文件头功能， 以降低误报率。 如果启用， 所有带有批注区域的文件将被视为没有被嵌入信息。 如果JPEG文件的JFIF标识符中的版本号不是1.1, 则禁用OutGuess检测。</p>
<p>-s：修改检测算法的敏感度， 该值的默认值为1。 检测结果的匹配度与检测算法的敏感度成正比， 算法敏感度的值越大， 检测出的可疑文件包含敏感信息的可能性越大。</p>
<p>-ct：打印带行号的调试信息。</p>
<p>-v：显示软件的版本编号。</p>
<p>-d num：打印调试信息。</p>
<p>6.3、对隐写工具的检测<br>-t：设置要检测哪些隐写工具（默认检测j opi), 可设置的选项如下：</p>
<p>-j：检测图像中的信息是否是用jsteg嵌入的。</p>
<p>-0：检测图像中的信息是否是用OU七 guess嵌入的。</p>
<p>-p：检测图像中的信息是否是用jphide嵌入的。</p>
<p>-i：检测图像中的信息是否是用 invisible secre七s嵌入的</p>
<h3 id="Jphswin-exe"><a href="#Jphswin-exe" class="headerlink" title="Jphswin.exe"></a>Jphswin.exe</h3><p>我用的是windows版本的，界面如下<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134615.png" alt="在这里插入图片描述"><br>使用起来也很简单，点击<code>open jpeg</code>打开图片，然后点击<code>seek</code>，如果有密码就输入密码，没有就直接回车<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134616.png" alt="在这里插入图片描述"></p>
<h3 id="Free-File-Camouflage"><a href="#Free-File-Camouflage" class="headerlink" title="Free_File_Camouflage"></a>Free_File_Camouflage</h3><p>不算太常见的一个软件，123分别是</p>
<blockquote>
<p>解密的图片的位置<br>如果有密码就勾选，然后输入密码，没有就直接跳过<br>解出文件放在什么位置</p>
</blockquote>
<p><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY5NjU2OA==,size_16,color_FFFFFF,t_70-166835285134617.png" alt="在这里插入图片描述"></p>
<h3 id="f5-steganography-（F5隐写，需要passwd）"><a href="#f5-steganography-（F5隐写，需要passwd）" class="headerlink" title="f5-steganography （F5隐写，需要passwd）"></a>f5-steganography （F5隐写，需要passwd）</h3><p>kali中安装，直接<code>git clone https://github.com/matthewgao/F5-steganography</code></p>
<p>具体使用：</p>
<pre><code class="python">进入f5-steganography文件夹后，打开终端
# 解密
java Extract filename.jpg -p 密码
运行后会在文件夹里生成一个output.txt，打开即可

# 加密
java Embed 原图.jpg 生成图.jpg -e 隐藏的文件.txt -p 密码
1234567
</code></pre>
<h3 id="outguess-（可需要passwd）"><a href="#outguess-（可需要passwd）" class="headerlink" title="outguess （可需要passwd）"></a>outguess （可需要passwd）</h3><p>kali中安装：</p>
<pre><code class="python">先下载
git clone https://github.com/crorvick/outguess
然后进入outguess文件夹，打开终端输入./configure &amp;&amp; make &amp;&amp; make install
成功之后即可
1234
</code></pre>
<p>使用：</p>
<pre><code class="python">进入文件夹后打开终端

加密
outguess -k 密码 -d hidden.txt 1.jpg 2.jpg
#hidden.txt是要隐写的内容，运行后1.jpg会覆盖2.jpg

解密
outguess -k 密码 -r 2.jpg out.txt
outguess -r 2.jpg out.txt   #不用密码的情况
123456789
</code></pre>
<h3 id="steghide"><a href="#steghide" class="headerlink" title="steghide"></a>steghide</h3><p>kali中的安装：<code>sudo apt-get install steghide</code></p>
<p>使用：</p>
<pre><code class="python">加密
steghide embed -cf out.jpg -ef flag.txt [-p 密码]
把flag.txt隐写到out.jpg中，如果要添加密码，尾部接上 -p 密码

解密
steghide info out.jpg  #查看图片中嵌入的文件信息
#提取隐藏内容
steghide extract -sf out.jpg -p 密码
steghide extract -sf out.jpg
123456789
</code></pre>
<p>steghide本身不支持爆破密码，可以借助<a target="_blank" rel="noopener" href="https://github.com/Va5c0/Steghide-Brute-Force-Tool">https://github.com/Va5c0/Steghide-Brute-Force-Tool</a></p>
<p>使用前还要安装一个库：<code>pip install progressbar2</code></p>
<p>使用方法：</p>
<pre><code class="python">python steg_brute.py -b -d [字典] -f [jpg_file]
1
</code></pre>
<p>这个工具用不了的话可以尝试<code>stegseek</code></p>
<h2 id="png-amp-bmp"><a href="#png-amp-bmp" class="headerlink" title="png &amp; bmp"></a>png &amp; bmp</h2><h3 id="普通盲水印"><a href="#普通盲水印" class="headerlink" title="普通盲水印"></a>普通盲水印</h3><p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a><br>具体安装过程自行百度</p>
<p>使用：</p>
<pre><code class="python">加密
python2 bwm.py encode 1.png water.png 2.png #PY2
python3 bwmforpy3.py encode 1.png water.png 2.png #PY3

解密
python2 bwm.py decode 1.png 2.png out.png  #PY2
python3 bwmforpy3.py decode 1.png 2.png out.png  #PY3
py2和py3的算法不一样，得到的out.png清晰度也不一样，建议都试一下

也可以加--alpha参数  可能会使图片更清晰
python3 bwmforpy3.py decode 1.png 2.png out.png --alpha 10 #PY3
1234567891011
</code></pre>
<h3 id="频域盲水印"><a href="#频域盲水印" class="headerlink" title="频域盲水印"></a>频域盲水印</h3><p>脚本：</p>
<pre><code class="python"># coding=utf-8
import cv2   
import numpy as np
import random
import os
from argparse import ArgumentParser
ALPHA = 5
def build_parser():
    parser = ArgumentParser()
    parser.add_argument(&#39;--original&#39;, dest=&#39;ori&#39;, required=True)
    parser.add_argument(&#39;--image&#39;, dest=&#39;img&#39;, required=True)
    parser.add_argument(&#39;--result&#39;, dest=&#39;res&#39;, required=True)
    parser.add_argument(&#39;--alpha&#39;, dest=&#39;alpha&#39;, default=ALPHA)
    return parser
def main():
    parser = build_parser()
    options = parser.parse_args()
    ori = options.ori
    img = options.img
    res = options.res
    alpha = options.alpha
    if not os.path.isfile(ori):
        parser.error(&quot;original image %s does not exist.&quot; % ori)
    if not os.path.isfile(img):
        parser.error(&quot;image %s does not exist.&quot; % img)
    decode(ori, img, res, alpha)
def decode(ori_path, img_path, res_path, alpha):
    ori = cv2.imread(ori_path)
    img = cv2.imread(img_path)
    ori_f = np.fft.fft2(ori)
    img_f = np.fft.fft2(img)
    height, width = ori.shape[0], ori.shape[1]
    watermark = (ori_f - img_f) / alpha
    watermark = np.real(watermark)
    res = np.zeros(watermark.shape)
    random.seed(height + width)
    x = range(height / 2)
    y = range(width)
    random.shuffle(x)
    random.shuffle(y)
    for i in range(height / 2):
        for j in range(width):
            res[x[i]][y[j]] = watermark[i][j]
    cv2.imwrite(res_path, res, [int(cv2.IMWRITE_JPEG_QUALITY), 100])
if __name__ == &#39;__main__&#39;:
    main()
12345678910111213141516171819202122232425262728293031323334353637383940414243444546
</code></pre>
<p>使用命令：<code>python BlindWaterMarkplus.py --original 1.png --image 2.png --result res.png</code></p>
<p>如果得到的res.png有问题，把1.png和2.png互换位置试一下</p>
<h3 id="zsteg（lsb隐写）"><a href="#zsteg（lsb隐写）" class="headerlink" title="zsteg（lsb隐写）"></a>zsteg（lsb隐写）</h3><p>kali安装：<code>gem install zsteg</code></p>
<p>使用：</p>
<pre><code class="python">zsteg 1.png
zsteg 1.bmp
12
</code></pre>
<h3 id="PNGDebugger-exe（检查IDAT块）"><a href="#PNGDebugger-exe（检查IDAT块）" class="headerlink" title="PNGDebugger.exe（检查IDAT块）"></a>PNGDebugger.exe（检查IDAT块）</h3><p>一般在windows系统下使用，在文件夹中打开cmd命令行</p>
<p>输入：<code>PNGDebugger.exe filename.png</code></p>
<h3 id="tweakpng-exe"><a href="#tweakpng-exe" class="headerlink" title="tweakpng.exe"></a>tweakpng.exe</h3><p>windows系统下的一个软件，是很好用的一个PNG图像浏览工具</p>
<p>用来<code>增加或者删除png图片的IDAT块</code>很方便，之前做过八神的一个题，就是删除了一个png的图片中的部分IDAT块，保存得到一张不同的图片，其中就有flag，这里因为对png的结构了解的不是很透彻，原理说不清楚。</p>
<p>在使用这个软件打开图片之前，建议先用<code>PNGDebugger</code>看一下图片中<strong>有多少IDAT块的crc32是出错</strong>的，因为在使用这个软件的时候，每一个错误都会有一个弹窗。</p>
<p>比如misc入门的<code>misc44</code>就不建议用这个软件打开</p>
<h3 id="png加密隐写"><a href="#png加密隐写" class="headerlink" title="png加密隐写"></a>png加密隐写</h3><p>工具<br><a target="_blank" rel="noopener" href="https://github.com/livz/cloacked-pixel">https://github.com/livz/cloacked-pixel</a></p>
<p>kali——CTF_py</p>
<p>用法：<code>python lsb.py extract keyword.png out lovekfc</code></p>
<p>示例：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44604541/article/details/111676599">(62条消息) 攻防世界 Misc高手进阶区 5分题 Keyword_思源湖的鱼的博客-CSDN博客</a></p>
<h3 id="PixelJihad-（png）"><a href="#PixelJihad-（png）" class="headerlink" title="PixelJihad （png）"></a>PixelJihad （png）</h3><p><a target="_blank" rel="noopener" href="https://sekao.net/pixeljihad/">PixelJihad (sekao.net)</a></p>
<h1 id="隐写总结"><a href="#隐写总结" class="headerlink" title="隐写总结"></a>隐写总结</h1><p><strong>总结：</strong></p>
<p><strong>个人推荐优先掌握熟练没有明显隐写特征的，有隐写特征的你过一眼，后期对照网站看一下就知道是那种隐写。</strong></p>
<hr>
<h1 id="没有明显隐写特征"><a href="#没有明显隐写特征" class="headerlink" title="没有明显隐写特征"></a>没有明显隐写特征</h1><h2 id="1-SilentEye"><a href="#1-SilentEye" class="headerlink" title="1.SilentEye"></a>1.SilentEye</h2><p><strong>支持类型：PNG、JPG、JPEG、BMP、TIF、TIFF、WAV</strong></p>
<p><strong>虽然可以隐写PNG格式，但是隐写保存的格式只能为JPG或者BMP</strong></p>
<ol>
<li>JPG类型特征：</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538472.jpg"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538472.jpg" alt="silenteye"></a></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538473.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538473.png" alt="image-20221108082326638"></a></p>
<p>如果你碰到了如下的图片，有很多小圆圈，那你用<code>stegsolve</code>也会看到很多的小圆圈，所以你就不要再去使用 <code>stegsolve</code> 去看通道了，直接大胆点盲猜图片被<code>SilentEye</code> 工具隐写了（图片来之[SICTF2023 Misc 王八树木]）</p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538474.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538474.png" alt="image-20230119140407725"></a></p>
<p>该题的层结构大小从上往下依次为<code>0x45, 0x45, 0x13, 0x21, 0xB7, 0x21, 0xB7</code>（注意：这个不是一定主要的技巧是使用 <code>stegsolve</code> 看通道）</p>
<ol>
<li>BMP类型没有太多特征</li>
</ol>
<h2 id="2-wbStego4"><a href="#2-wbStego4" class="headerlink" title="2.wbStego4"></a>2.wbStego4</h2><p><strong>支持类型：BMP、RLE、PDF（常见）</strong></p>
<ol>
<li>BMP类型特征：</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538475.jpg"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538475.jpg" alt="wbStego4"></a></p>
<p>最低位有明显隐写特征</p>
<ol>
<li>PDF类型特征：</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538476.jpg"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538476.jpg" alt="wb4_pdf"></a></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538477.jpg"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538477.jpg" alt="wb4_pdf2"></a></p>
<p>有明显的：<code>09 09 09 20 20 09 20 09 0D</code>的字节特征，主要字节是<code>09 20 0D</code>。</p>
<p>以下内容来源：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sherlson/articles/15851383.html">https://www.cnblogs.com/sherlson/articles/15851383.html</a></p>
<pre><code>plaintext
wbStego4open是一个隐写开源工具，它支持Windows和Linux平台。
你可以用wbStego4open可以把文件隐藏到BMP、TXT、HTM和PDF文件中，且不会被看出破绽。
还可以用它来创建版权标识文件并嵌入到文件中将其隐藏。
wbStego在插入数据时（此处以非加密的版权信息为例），充分利用了插入法和LSB修改法两种技术。
wbStego4open会把插入数据中的每一个ASCII码转换为二进制形式，
然后把每一个二进制数字再替换为十六进制的20或者09，20代表0，09代表1。
例如，在wbStego4open的版权管理器（Copyright Manager）中，输入一个包含“Oblivion”的地址，
wbStego4open就会将其由ASCII码转换成相应的二进制码，
然后再用0x20和0x09替换每个二进制数。
</code></pre>
<p>如何判断是否文件采用<code>wbStego4open</code>加密？</p>
<ol>
<li>将文件导入010editor、winhex之类的十六进制查看工具</li>
<li>如果<code>20</code>、<code>09</code>出现次数较多，则有可能为<code>wbStego4open</code>加密</li>
<li><strong>当隐写的内容很少的时候大概率没有20、09出现最多的特征了，最好参考上图的字节特征。</strong></li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538479.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538479.png" alt="image-20221202162449054"></a></p>
<h2 id="3-cloacked-pixel"><a href="#3-cloacked-pixel" class="headerlink" title="3.cloacked-pixel"></a>3.cloacked-pixel</h2><p><strong>支持类型：PNG、JPG(隐写后自动转换为PNG)</strong></p>
<p>特征如下：</p>
<ol>
<li>IDAT层大小</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538480.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538480.png" alt="image-20221115180358321"></a></p>
<p>IDAT结构大小会为0x1000C，其中length占4字节，IDAT标记占4字节，内容占65536字节，CRC32占4字节。</p>
<p><code>65536 + length + IDAT + CRC32 = 0x1000C</code>，也就是每个IDAT层会被装满。</p>
<ol>
<li>图片位深度32位，但是你使用<code>StegSolve</code>观察图片的时候，Alpha通道全部都是255，也就是白色。</li>
</ol>
<h2 id="4-steghide"><a href="#4-steghide" class="headerlink" title="4.steghide"></a>4.steghide</h2><p><strong>支持类型：JPEG、BMP、WAV 和 AU</strong></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538481.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538481.png" alt="image-20221115190104544"></a></p>
<p>层大小从上往下依次为<code>0x45, 0x45, 0x13, 0x21, 0xB7, 0x21, 0xB7</code></p>
<h2 id="5-outguess"><a href="#5-outguess" class="headerlink" title="5.outguess"></a>5.outguess</h2><p><strong>支持类型：JPG</strong></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538481.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538481.png" alt="image-20221115190104544"></a></p>
<p>层大小从上往下依次为<code>0x45, 0x45, 0x13, 0x21, 0xB7, 0x21, 0xB7</code></p>
<h2 id="6-stegpy"><a href="#6-stegpy" class="headerlink" title="6.stegpy"></a>6.stegpy</h2><p><strong>支持类型：PNG、JPG、GIF、BMP、WEBP、&#x3D;&#x3D;WAV&#x3D;&#x3D;</strong></p>
<p><strong>除了PNG格式其他的图片格式隐写后自动转换为PNG</strong></p>
<p>特征如下：</p>
<ol>
<li>IDAT层大小</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538480.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538480.png" alt="image-20221115180358321"></a></p>
<p>IDAT结构大小会为0x1000C，其中length占4字节，IDAT标记占4字节，内容占65536字节，CRC32占4字节。</p>
<p><code>65536 + length + IDAT + CRC32 = 0x1000C</code>，也就是每个IDAT层会被装满。</p>
<ol>
<li>图片位深度32位，但是你使用<code>StegSolve</code>观察图片的时候，Alpha通道全部都是255，也就是白色。</li>
</ol>
<h2 id="7-jphide"><a href="#7-jphide" class="headerlink" title="7.jphide"></a>7.jphide</h2><p><strong>支持类型：JPG、JPEG</strong></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538482.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538482.png" alt="image-20221118192116807"></a></p>
<p>层大小从上往下依次为<code>0x45, 0x45, 0x13, 0x21, 0x8D, 0x21, 0x84</code></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538483.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538483.png" alt="image-20221118193139991"></a></p>
<p>bugku奇怪的压缩包中的<code>xiaoxiaoshumu.jpg</code>，也出现了不一样的情况</p>
<p>层大小从上往下依次为<code>0x45, 0x45, 0x13, 0x1E, 0x53, 0x1C, 0x2A</code></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538484.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538484.png" alt="image-20221209130453397"></a></p>
<p>首届“天权信安&amp;catf1ag”网络安全联合公开赛中的一题<code>嘿嘿.jpg</code>，也出现了不一样情况</p>
<p>层大小从上往下依次为<code>0x45, 0x45, 0x13, 0x1E, 0x4D, 0x1B, 0x25</code></p>
<h2 id="8-F5-steganography"><a href="#8-F5-steganography" class="headerlink" title="8.F5-steganography"></a>8.F5-steganography</h2><p>特征：<strong>早期F5算法总插入</strong><code>AJPEG Encoder Copyright 1998, James R. Weeks and BioElectroMech.</code></p>
<p>命令<code>java Extract 图片名称 (-p password)</code>会生成output.txt，隐写内容就在里面。</p>
<p>（这个我也没玩的很透彻，但是我在手动尝试隐写的时候发现注释也是可以修改的）</p>
<h2 id="9-JSteg"><a href="#9-JSteg" class="headerlink" title="9.JSteg"></a>9.JSteg</h2><p>JPG特征：</p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538492.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538492.png" alt="image-20221213144232849"></a></p>
<p>层大小从上往下依次为<code>0x86, 0x13, 0x1A4</code></p>
<hr>
<h1 id="有明显隐写特征"><a href="#有明显隐写特征" class="headerlink" title="有明显隐写特征"></a>有明显隐写特征</h1><h2 id="1-Free-File-Camouflage"><a href="#1-Free-File-Camouflage" class="headerlink" title="1.Free File Camouflage"></a>1.Free File Camouflage</h2><p><strong>支持类型：JPG</strong></p>
<ol>
<li>尾部会出现很多base64字段</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538485.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538485.png" alt="image-20221118193524649"></a></p>
<ol>
<li>如果隐写的内容较少会出现，你会看见尾部的特征结构如下：</li>
</ol>
<pre><code>FF D9` + `第一段base64` + `0D 0A` + `第二段base64` + `0D 0A
</code></pre>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538486.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538486.png" alt="image-20221118193630649"></a></p>
<h2 id="2-DeEgger-Embedder"><a href="#2-DeEgger-Embedder" class="headerlink" title="2.DeEgger Embedder"></a>2.DeEgger Embedder</h2><p><strong>支持类型：PNG、JPG</strong></p>
<p><strong>PNG特征：</strong></p>
<ol>
<li>尾部会出现很多无意义的字符</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538487.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538487.png" alt="image-20221118194554713"></a></p>
<ol>
<li>IDAT层的大小都为<code>0x200C</code>（除了最后一层IDAT）</li>
</ol>
<p><strong>JPG特征：</strong></p>
<ol>
<li>尾部会出现很多无意义的字符</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538488.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538488.png" alt="image-20221118194949346"></a></p>
<h2 id="3-OurSecret"><a href="#3-OurSecret" class="headerlink" title="3.OurSecret"></a>3.OurSecret</h2><ol>
<li>JPG特征：</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538489.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538489.png" alt="image-20221208221306007"></a></p>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538490.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538490.png" alt="image-20221208221342521"></a></p>
<p>特征是这个<code>ž—º*</code>，会在jpg文件层结束后出现。</p>
<p>尾部特征是<code>l&lt;9l0kl10n88j:8&lt;....</code></p>
<ol>
<li>PNG特征：</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://byxs20-picture-for-typora.oss-cn-hangzhou.aliyuncs.com/img_for_typora/202302061538491.png"><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/202302061538491.png" alt="image-20221208221706530"></a></p>
<p>和上述的JPG特征一样。</p>
<h1 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h1><h2 id="二进制转二维码"><a href="#二进制转二维码" class="headerlink" title="二进制转二维码"></a>二进制转二维码</h2><p>这里以bugku中的<code>神奇宝贝</code>为例</p>
<p>拿到一串二进制，如果它的<code>长度被开方后正好是整数</code>，比如这题，满足<code>625=25*25</code>，就可以考虑转二维码。</p>
<pre><code class="python">import PIL
from PIL import Image
MAX = 25  #图片边长
img = Image.new(&quot;RGB&quot;,(MAX,MAX))
str=&quot;1111111001110111001111111100000100001101010100000110111010011100101010111011011101010110000101011101101110101010111010101110110000010011001101010000011111111010101010101111111000000000100101000000000011000111011010110000110001000000010100001010111100001011110101100111110011100101101001100101010010111000101011100100101101001111110000110101011110011010000010010001011100001111000010011101010110001100101110101000111011111010100000000110001101000110001111111011001100101010101100000101111001110001100010111010011100011111101111011101001101111011010011101110100010011010010010110000010100011010011110011111111011011100101010001&quot;
i = 0
for y in range (0,MAX):
    for x in range (0,MAX):
        if(str[i] == &#39;1&#39;):
            img.putpixel([x,y],(0, 0, 0))
        else:
            img.putpixel([x,y],(255,255,255))
        i = i+1
img.show()
img.save(&quot;flag.png&quot;)
123456789101112131415
</code></pre>
<h2 id="二维码的修复"><a href="#二维码的修复" class="headerlink" title="二维码的修复"></a>二维码的修复</h2><p>有的时候，得到的二维码是不完整的，如果缺失的部分比较少，是可以直接扫出来的。</p>
<p>缺失部分比较多的时候就要考虑修复了，这里以bugku的<code>Improve yourself</code>为例，其中一步得到的二维码缺了三块定位符。<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAei52b2xjYW5v,size_19,color_FFFFFF,t_70,g_se,x_16.png" alt="在这里插入图片描述"><br>这里推荐一个在线网站，<a target="_blank" rel="noopener" href="https://merricx.github.io/qrazybox/pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAei52b2xjYW5v,size_20,color_FFFFFF,t_70,g_se,x_16.png)">https://merricx.github.io/qrazybox/，进去的页面如下，蓝色箭头位置是二维码大小，根据实际情况进行修改。![在这里插入图片描述](/../pic/CTF——MISC——图片隐写.assets/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAei52b2xjYW5v,size_20,color_FFFFFF,t_70,g_se,x_16.png)</a><br>红色箭头位置也可以点击，这里根据实际情况对定位符的一些设置进行修改。<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAei52b2xjYW5v,size_20,color_FFFFFF,t_70,g_se,x_16-166835285134618.png" alt="在这里插入图片描述"><br>有的时候，题目给了一个图片文件，打开发现是只有上半部分的二维码，一般把图片高度改高就能得到完整的二维码。</p>
<h2 id="Aztec-Code"><a href="#Aztec-Code" class="headerlink" title="Aztec Code"></a>Aztec Code</h2><p>大概长这样<br><img src="/../pic/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99.assets/10f5966a6f034e40b0f7c09ab2dc592c.gif" alt="请添加图片描述"><br>使用在线网站进行解码：<a target="_blank" rel="noopener" href="https://products.aspose.app/barcode/recognize/aztec#result">https://products.aspose.app/barcode/recognize/aztec#result</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Daniel</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://eatingcrime.github.io/2023/03/07/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/">https://eatingcrime.github.io/2023/03/07/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Daniel</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/03/23/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/21.jpg" class="responsive-img" alt="渗透测试">
                        
                        <span class="card-title">渗透测试</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-03-23
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/03/07/CTF%E2%80%94%E2%80%94MISC%E2%80%94%E2%80%94%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="MISC—音频隐写">
                        
                        <span class="card-title">MISC—音频隐写</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-03-07
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="917184825"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">Daniel</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/eatingcrime" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1012375523@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=101237523" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 101237523" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    
        <!-- <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script> -->
        <script src='/libs/mermaid/mermaid.min.js'></script>
        <script>
          if (window.mermaid) {
            mermaid.initialize({theme: 'forest'});
          }
        </script>
    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
